<hr />
<p>title: ‘随笔 - C++ 中的 std::transform 用法 (C++11)’<br />
categories:</p>
<ul>
<li>随笔</li>
<li>C++<br />
tags:</li>
<li>随笔</li>
<li>C++<br />
abbrlink: 603d331<br />
date: 2021-01-26 18:31:47</li>
</ul>
<hr />
<p>简要记录 <code>std::transform</code> 的用法</p>
<!-- more -->
<h2 id="声明"><a class="markdownIt-Anchor" href="#声明"></a> 声明</h2>
<p>{% tabs tabs_1,1 %}</p>
<!-- tab 一元 -->
<pre class="highlight"><code class="cpp">  <span class="hljs-comment">/**
   *  @brief Perform an operation on a sequence.
   *  @ingroup mutating_algorithms
   *  @param  __first     An input iterator.
   *  @param  __last      An input iterator.
   *  @param  __result    An output iterator.
   *  @param  __unary_op  A unary operator.
   *  @return   An output iterator equal to @p __result+(__last-__first).
   *
   *  Applies the operator to each element in the input range and assigns
   *  the results to successive elements of the output sequence.
   *  Evaluates @p *(__result+N)=unary_op(*(__first+N)) for each @c N in the
   *  range @p [0,__last-__first).
   *
   *  @p unary_op must not alter its argument.
  */</span>
  <span class="hljs-keyword">template</span>&lt;<span class="hljs-keyword">typename</span> _InputIterator, <span class="hljs-keyword">typename</span> _OutputIterator,
	   <span class="hljs-keyword">typename</span> _UnaryOperation&gt;
    <span class="hljs-function">_OutputIterator
    <span class="hljs-title">transform</span><span class="hljs-params">(_InputIterator __first, _InputIterator __last,
	      _OutputIterator __result, _UnaryOperation __unary_op)</span></span>;
</code></pre>
<!-- endtab -->
<!-- tab 二元 -->
<pre class="highlight"><code class="cpp">  <span class="hljs-comment">/**
   *  @brief Perform an operation on corresponding elements of two sequences.
   *  @ingroup mutating_algorithms
   *  @param  __first1     An input iterator.
   *  @param  __last1      An input iterator.
   *  @param  __first2     An input iterator.
   *  @param  __result     An output iterator.
   *  @param  __binary_op  A binary operator.
   *  @return   An output iterator equal to @p result+(last-first).
   *
   *  Applies the operator to the corresponding elements in the two
   *  input ranges and assigns the results to successive elements of the
   *  output sequence.
   *  Evaluates @p
   *  *(__result+N)=__binary_op(*(__first1+N),*(__first2+N)) for each
   *  @c N in the range @p [0,__last1-__first1).
   *
   *  @p binary_op must not alter either of its arguments.
  */</span>
  <span class="hljs-keyword">template</span>&lt;<span class="hljs-keyword">typename</span> _InputIterator1, <span class="hljs-keyword">typename</span> _InputIterator2,
	   <span class="hljs-keyword">typename</span> _OutputIterator, <span class="hljs-keyword">typename</span> _BinaryOperation&gt;
    <span class="hljs-function">_OutputIterator
    <span class="hljs-title">transform</span><span class="hljs-params">(_InputIterator1 __first1, _InputIterator1 __last1,
	      _InputIterator2 __first2, _OutputIterator __result,
	      _BinaryOperation __binary_op)</span></span>;
</code></pre>
<!-- endtab -->
<p>{% endtabs %}</p>
<h2 id="作用"><a class="markdownIt-Anchor" href="#作用"></a> 作用</h2>
<p>{% tabs tabs_2,1 %}</p>
<!-- tab 一元 -->
<p>对 <code>[__first,__last)</code> 内的元素应用 <code>__unary_op</code>, 并将结果储存在以 <code>__result</code> 开头的区域内</p>
<!-- endtab -->
<!-- tab 二元 -->
<p>对 <code>[__first1,__last1)</code> 和 <code>[__first2,__first2+__last1-__first1)</code> 内的元素应用 <code>__binary_op</code>, 并将结果储存在以 <code>__result</code> 开头的区域内</p>
<!-- endtab -->
<p>{% endtabs %}</p>
<h2 id="示例"><a class="markdownIt-Anchor" href="#示例"></a> 示例</h2>
<pre class="highlight"><code class="cpp"><span class="hljs-comment">// from https://zh.cppreference.com/w/cpp/algorithm/transform</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;algorithm&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;cctype&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;string&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;vector&gt;</span></span>
 
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-function"><span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> <span class="hljs-title">s</span><span class="hljs-params">(<span class="hljs-string">"hello"</span>)</span></span>;
    <span class="hljs-built_in">std</span>::transform(s.begin(), s.end(), s.begin(),
                   [](<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span> c) -&gt; <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span> { <span class="hljs-keyword">return</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">toupper</span>(c); }); <span class="hljs-comment">// HELLO</span>
 
    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-built_in">std</span>::<span class="hljs-keyword">size_t</span>&gt; ordinals;
    <span class="hljs-built_in">std</span>::transform(s.begin(), s.end(), <span class="hljs-built_in">std</span>::back_inserter(ordinals),
                   [](<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span> c) -&gt; <span class="hljs-built_in">std</span>::<span class="hljs-keyword">size_t</span> { <span class="hljs-keyword">return</span> c; }); <span class="hljs-comment">// {'H', 'E', 'L', 'L', 'O'} = {72, 69, 76, 76, 79}</span>
 
    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span> &lt;&lt; s &lt;&lt; <span class="hljs-string">':'</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> ord : ordinals) {
       <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">' '</span> &lt;&lt; ord;
    }
 
    <span class="hljs-built_in">std</span>::transform(ordinals.cbegin(), ordinals.cend(), ordinals.cbegin(),
                   ordinals.begin(), <span class="hljs-built_in">std</span>::plus&lt;&gt;{}); <span class="hljs-comment">// {72+72, 69+69, 76+76, 76+76, 79+79} = {144, 138, 152, 152, 158}</span>
 
    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">'\n'</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> ord : ordinals) {
       <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span> &lt;&lt; ord &lt;&lt; <span class="hljs-string">' '</span>;
    }
    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">'\n'</span>;
}
</code></pre>
<h3 id="输出"><a class="markdownIt-Anchor" href="#输出"></a> 输出</h3>
<pre class="highlight"><code class="">HELLO: 72 69 76 76 79
144 138 152 152 158
</code></pre>
<h3 id="tips"><a class="markdownIt-Anchor" href="#tips"></a> Tips</h3>
<p>以下程序和示例程序等价</p>
<pre class="highlight"><code class="cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-function"><span class="hljs-built_in">string</span> <span class="hljs-title">s</span><span class="hljs-params">(<span class="hljs-string">"hello"</span>)</span></span>;
    transform(s.begin(), s.end(), s.begin(), ::<span class="hljs-built_in">toupper</span>); <span class="hljs-comment">// Attention</span>

    <span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">size_t</span>&gt; ordinals;
    transform(s.begin(), s.end(), back_inserter(ordinals), [](<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span> c) -&gt; <span class="hljs-keyword">size_t</span> { <span class="hljs-keyword">return</span> c; });

    <span class="hljs-built_in">cout</span> &lt;&lt; s &lt;&lt; <span class="hljs-string">':'</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> ord : ordinals) {
        <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">' '</span> &lt;&lt; ord;
    }

    transform(ordinals.cbegin(), ordinals.cend(), ordinals.cbegin(), ordinals.begin(), plus&lt;&gt;{});

    <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">'\n'</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> ord : ordinals) {
        <span class="hljs-built_in">cout</span> &lt;&lt; ord &lt;&lt; <span class="hljs-string">' '</span>;
    }
    <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">'\n'</span>;
}
</code></pre>
<p>此处要注意一点, 因为 <code>using namespace std;</code>, 致使 <code>&lt;cctype&gt;</code> 中的 <code>toupper</code> 和 <code>&lt;locale&gt;</code> 中的 <code>std::toupper</code> 发生混淆, 此时需要加 <code>::</code> 限定作用域</p>
<hr />
<h2 id="主要参考资料"><a class="markdownIt-Anchor" href="#主要参考资料"></a> 主要参考资料</h2>
<ul>
<li><a href="https://en.cppreference.com/w/cpp/algorithm/transform">std::transform - cppreference.com</a></li>
</ul>
